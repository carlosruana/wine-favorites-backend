{"version":3,"file":"vivinoScraper.js","sourceRoot":"","sources":["../../src/utils/vivinoScraper.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,kDAA0B;AAC1B,qCAA+B;AAExB,MAAM,YAAY,GAAG,CAAO,QAAgB,EAAE,EAAE;IACrD,MAAM,GAAG,GAAG,yCAAyC,kBAAkB,CAAC,QAAQ,CAAC,EAAE,CAAC;IAEpF,IAAI,CAAC;QACH,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,eAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACtC,MAAM,CAAC,GAAG,IAAA,cAAI,EAAC,IAAI,CAAC,CAAC;QAErB,MAAM,OAAO,GAOR,EAAE,CAAC;QAER,yDAAyD;QACzD,CAAC,CAAC,yCAAyC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE;YAC/D,MAAM,IAAI,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YAC/D,MAAM,IAAI,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YAEtE,iEAAiE;YACjE,IAAI,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;YACzE,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;gBAC9B,4DAA4D;gBAC5D,MAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;gBACvD,IAAI,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAG,CAAC,CAAC,EAAE,CAAC;oBACf,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnB,CAAC;qBAAM,CAAC;oBACN,KAAK,GAAG,EAAE,CAAC;gBACb,CAAC;YACH,CAAC;iBAAM,CAAC;gBACN,KAAK,GAAG,EAAE,CAAC;YACb,CAAC;YAED,MAAM,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YACnE,MAAM,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YACjE,MAAM,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YAEjE,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,EAAE,CAAC;gBACvD,OAAO,CAAC,IAAI,CAAC;oBACX,IAAI;oBACJ,IAAI,EAAE,yBAAyB,IAAI,EAAE;oBACrC,KAAK;oBACL,MAAM;oBACN,MAAM;oBACN,KAAK;iBACN,CAAC,CAAC;YACL,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,GAAG,CAAC,WAAW,OAAO,CAAC,MAAM,QAAQ,CAAC,CAAC,CAAC,kCAAkC;QAClF,OAAO,OAAO,CAAC;IACjB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;QAC/C,MAAM,KAAK,CAAC;IACd,CAAC;AACH,CAAC,CAAA,CAAC;AAzDW,QAAA,YAAY,gBAyDvB","sourcesContent":["import axios from 'axios';\nimport { load } from 'cheerio';\n\nexport const scrapeVivino = async (wineName: string) => {\n  const url = `https://www.vivino.com/search/wines?q=${encodeURIComponent(wineName)}`;\n  \n  try {\n    const { data } = await axios.get(url);\n    const $ = load(data);\n    \n    const results: Array<{\n      name: string;\n      link: string;\n      image: string;\n      origin: string;\n      rating: string;\n      price: string;\n    }> = [];\n\n    // Usar el selector actualizado para las tarjetas de vino\n    $('.search-results-list .default-wine-card').each((_, element) => {\n      const name = $(element).find('.wine-card__name').text().trim();\n      const link = $(element).find('.wine-card__name a').attr('href') || '';\n      \n      // Obtener la URL de la imagen desde el estilo 'background-image'\n      let image = $(element).find('.wine-card__image').css('background-image');\n      if (typeof image === 'string') {\n        // Extraer la URL de la imagen del estilo 'background-image'\n        const match = image.match(/url\\([\"']?([^\"']*)[\"']?\\)/);\n        if (match?.[1]) {\n          image = match[1];\n        } else {\n          image = '';\n        }\n      } else {\n        image = '';\n      }\n\n      const origin = $(element).find('.wine-card__region').text().trim();\n      const rating = $(element).find('.average__number').text().trim();\n      const price = $(element).find('.wine-price-value').text().trim();\n\n      if (name && link && image && origin && rating && price) {\n        results.push({\n          name,\n          link: `https://www.vivino.com${link}`,\n          image,\n          origin,\n          rating,\n          price,\n        });\n      }\n    });\n\n    console.log(`Scraped ${results.length} wines`); // Log the number of wines scraped\n    return results;\n  } catch (error) {\n    console.error('Error scraping Vivino:', error);\n    throw error;\n  }\n};\n"]}